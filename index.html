<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.22/jspdf.plugin.autotable.min.js"></script>

    <title>Work Hours &amp; Salary Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: url('https://i.ibb.co/GR5DzNJ/Background-Color.jpg') no-repeat center center fixed;
            background-size: cover;
            margin: 0;
            color: #333;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem;
            text-align: center;
            background-color: rgba(248, 248, 248, 0.9);
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4);
            max-width: 1000px;
            margin: 2rem auto;
        }

        h1 {
            color: #376f39;
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        @keyframes rotate {
            0% {
                transform: rotate(0deg);
            }

            50% {
                transform: rotate(90deg);
            }

            100% {
                transform: rotate(0deg);
            }
        }

        .phone-container {
            text-align: center;
            margin-top: 1rem;
        }

        .phone-icon {
            width: 50px;
            height: 80px;
            animation: rotate 4s linear infinite;
        }

        .table-container {
            width: 100%;
            overflow-x: auto;
        }

        table {
            width: 100%;
            max-width: 100%; 
            border-collapse: collapse;
            margin-top: 1rem;
        }

        th,
        td {
            border: 1px solid #bebebe;
            padding: 0.4rem;
            text-align: center;
            background-color: white;
        }

        th {
            background-color: #376f39;
            color: white;
        }

        /* Specific styles for Hourly Rate and Salary columns */
    th:nth-child(6), td:nth-child(6) { /* Hourly Rate column */
        width: 12%; /* Adjust as needed for a narrower column */
    }

    th:nth-child(7), td:nth-child(7) { /* Salary column */
        width: 18%; /* Adjust as needed for a wider column */
    }

        input[type="text"],
        input[type="date"],
        input[type="time"],
        input[type="number"] {
            width: 100%;
            padding: 0.5rem;
            box-sizing: border-box;
            margin: 0.5rem 0;
        }

        button {
            background-color: #056300b8;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            margin: 10px;
            cursor: pointer;
            transition: all 0.6s ease;
        }
        button:hover {
            transform: scale(1.15);
            background-color: #d16200c2;
        }

        .summary,
        .weekly-summary,
        .monthly-summary {
            margin-top: 2rem;
            font-size: 1em;
            text-align: left;
            width: 100%;
            max-width: 625px;
            background-color: #f9f9f9;
            padding: 1rem;
            border-radius: 6px;
            border: 2px solid #bebebe;
        }

        .additional-earnings {
    background: rgba(255, 248, 240, 0.8);
    padding: 1rem;
    border-radius: 6px;
    margin-top: 1.5rem;
    width: 90%;
    max-width: 600px;
    text-align: center;
}

.additional-earnings table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
}

.additional-earnings th,
.additional-earnings td {
    border: 1px solid #bebebe;
    padding: 0.5rem;
    text-align: center;
    background-color: white;
}

.additional-earnings th {
    background-color: #376f39;
    color: white;
    font-size: 0.9rem;
}

.additional-earnings select,
.additional-earnings input {
    width: 80%;
    padding: 0.4rem;
    font-size: 0.9rem;
    text-align: center;
}

.symmetric-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 0.8rem;
    table-layout: fixed; /* Ensures equal column widths */
}

.symmetric-table th,
.symmetric-table td {
    border: 1px solid #bebebe;
    padding: 0.6rem;
    text-align: center;
    background-color: white;
    width: 50%; /* Ensures equal width for both columns */
}

.symmetric-table th {
    background-color: #376f39;
    color: white;
    font-size: 0.8rem;
}

.symmetric-table select,
.symmetric-table input {
    width: 80%;
    padding: 0.4rem;
    font-size: 0.8rem;
    text-align: center;
    border: 1px solid #bebebe;
    border-radius: 4px;
}



        .orientation-note {
            margin-top: 1rem;
            padding: 1rem;
            background-color: white;
            border: 2px solid #bebebe;
            border-radius: 6px;
            width: 100%;
            max-width: 400px;
            margin: 1rem auto;
            color: #555;
            text-align: center;
        }

        .error {
            color: red;
            font-weight: bold;
            display: none;
        }

        .instruction {
            display: none;
            background-color: rgba(250, 235, 225, 0.9);
            padding: 1rem;
            border-radius: 6px;
            margin-top: 2rem;
            font-size: 1em;
            width: 100%;
            max-width: 600px;
            text-align: left;
        }

        #toggleInstructionEnglish,
        #toggleInstructionPolish {
            background-color:#ff9a42db;
            color: white;
            padding: 0.7rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 0.5rem;
        }

        #toggleInstructionEnglish:hover,
        #toggleInstructionPolish:hover {
            background-color: #764be0d1;
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 1.4rem;
            }

            table,
            th,
            td {
                font-size: 0.8rem;
            }

            button {
                padding: 0.5rem;
                font-size: 0.8rem;
            }

            .summary,
            .night-out-table {
                font-size: 0.8rem;
            }

            .orientation-note {
                font-size: 0.7rem;
            }
        }

        .footer {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 2rem;
            font-size: 0.5rem;
        }

        .footer img {
            width: 40px;
            height: auto;
            margin-right: 5px;
        }

        .small-text {
            font-size: smaller;
            color: #666;
        }
    </style>
    
 
</head>

<body>
    <div class="container">
        <h1>Work Hours &amp; Salary Tracker</h1>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Day</th>
                        <th>Date</th>
                        <th>Start Time</th>
                        <th>End Time</th>
                        <th>Hours Worked</th>
                        <th>Hourly Rate</th>
                        <th>Salary</th>
                        <th>Night Out</th>
                    </tr>
                </thead>
                <tbody id="workTable">
                    <script>
                        const days = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
                        for (let i = 1; i <= 14; i++) {
                            const dayName = days[(i - 1) % 7];
                            const weekText = (i <= 7) ? "Week 1" : "Week 2"; // Determine the week
                            const rate = (days[(i - 1) % 7] === "Saturday" || days[(i - 1) % 7] === "Sunday") ? "17.5" : "15.5";
                            document.write(`
                                <tr>
                                    <td>
                                        <div>
                                            <span>${dayName}</span><br>
                                            <span class="small-text">${weekText}</span>
                                        </div>
                                    </td>
                                    <td><input type="date" id="date${i}" aria-label="Date for ${dayName}"></td>
                                    <td><input type="time" id="start${i}" aria-label="Start time for ${dayName}"></td>
                                    <td><input type="time" id="end${i}" aria-label="End time for ${dayName}"></td>
                                    <td id="hours${i}">0</td>
                                    <td><input type="number" id="rate${i}" step="0.01" value="${rate}" aria-label="Hourly rate for ${dayName}"></td>
                                    <td id="salary${i}">0</td>
                                    <td><input type="checkbox" id="nightOut${i}" onclick="updateNightOutCount()"></td>
                                </tr>
                            `);
                        }
                    </script>
                </tbody>
            </table>
        </div>

        <div class="additional-earnings">
    <h3>Additional Earnings</h3>
    <table>
        <thead>
            <tr>
                <th>Number of Nights Week 1</th>
                <th>Rate per Night</th>
                <th>Total Night Out Pay</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><span id="nightOutDaysWeek1">0</span></td>
                <td><input aria-label="Rate per Night Week 1" id="nightOutRateWeek1" step="0.01" type="number" value="28" /></td>
                <td id="nightOutTotalWeek1">0.00</td>
            </tr>
        </tbody>
    </table>
    <table>
        <thead>
            <tr>
                <th>Number of Nights Week 2</th>
                <th>Rate per Night</th>
                <th>Total Night Out Pay</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><span id="nightOutDaysWeek2">0</span></td>
                <td><input aria-label="Rate per Night Week 2" id="nightOutRateWeek2" step="0.01" type="number" value="28" /></td>
                <td id="nightOutTotalWeek2">0.00</td>
            </tr>
        </tbody>
    </table>
    <table class="symmetric-table">
    <thead>
        <tr>
            <th>Unpaid Break</th>
            <th>Expenses</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                <select id="unpaidBreak">
                    <option value="0">0 min</option>
                    <option value="15">15 min</option>
                    <option value="30">30 min</option>
                    <option value="45">45 min</option>
                    <option value="60">1 hour</option>
                    <option value="75">1 hour 15 min</option>
                    <option value="90">1 hour 30 min</option>
                    <option value="105">1 hour 45 min</option>
                    <option value="120">2 hours</option>
                </select>
            </td>
            <td>
                <input type="number" id="expenses" step="0.01" placeholder="0.00">
            </td>
        </tr>
    </tbody>
</table>

</div>

         
        <div>
            <button onclick="calculateAll()">Calculate All</button>
            <button onclick="saveData()">Save Data</button>
            <button onclick="loadData()">Load Data</button>
            <button onclick="downloadExcel()">Download Data (Excel)</button>
            <button onclick="generatePDF()">Download Report (PDF)</button>

        </div>

        <div class="summary">
            <p><strong>Total Hours Worked: </strong><span id="totalHours">0</span> hours</p>
            <p><strong>Total Salary: </strong>£<span id="totalSalary">0</span></p>
            <p><strong>Total Salary including Night Out: </strong>£<span id="totalWithNightOut">0</span></p>
        </div>

        <div class="weekly-summary">
            <h3>Weekly Summary</h3>
            <p><strong>Week 1: </strong>Total Hours: <span id="week1Hours">0</span>, Total Salary: £<span id="week1Salary">0</span>, Total including Night Out: £<span id="week1TotalWithNightOut">0</span></p>
            <p><strong>Week 2: </strong>Total Hours: <span id="week2Hours">0</span>, Total Salary: £<span id="week2Salary">0</span>, Total including Night Out: £<span id="week2TotalWithNightOut">0</span></p>
            <p><strong>Total Salary including Nights Out for Week 1 & Week 2: </strong>£<span id="totalSalaryCombined">0</span></p>
        </div>

      

        <div class="error" id="errorMessages"></div>

        <button id="toggleInstructionPolish" onclick="toggleInstructionLanguage('polish')">Show/Hide Polish Instructions</button>
        <button id="toggleInstructionEnglish" onclick="toggleInstructionLanguage('english')">Show/Hide English Instructions</button>

        <div id="instructionPolish" class="instruction">
            <h2>Instrukcja Obsługi Work Hours & Salary Tracker</h2>

    <h3>1. Wprowadzanie danych o godzinach pracy</h3>
    <p>W sekcji głównej strony wprowadź dane dotyczące przepracowanych godzin:</p>
    <ul>
        <li><strong>Dzień tygodnia:</strong> W tabeli widoczne są dni tygodnia w dwóch tygodniach pracy (Week 1 i Week 2).</li>
        <li><strong>Data:</strong> Wprowadź datę w kolumnie <em>Date</em> (format: dzień-miesiąc-rok).</li>
        <li><strong>Godzina rozpoczęcia i zakończenia pracy:</strong> Wypełnij pola <em>Start Time</em> i <em>End Time</em>. Jeśli godziny pracy przekraczają północ, system automatycznie dostosuje obliczenia.</li>
        <li><strong>Stawka godzinowa:</strong> Domyślnie ustawiona na £15.5 dla dni roboczych i £17.5 dla weekendów. Możesz zmienić stawkę ręcznie, wpisując wartość w odpowiednie pole.</li>
    </ul>
    <p>Po wprowadzeniu danych kliknij przycisk <strong>Calculate All</strong>, aby obliczyć przepracowane godziny oraz wynagrodzenie.</p>

    <h3>2. Tabela Additional Earnings</h3>
    <p>Ta sekcja umożliwia dodanie dodatkowych informacji związanych z przerwami i kosztami:</p>
    <ul>
        <li><strong>Unpaid Break:</strong> Wybierz długość niepłatnej przerwy (w minutach) z rozwijanej listy. System automatycznie uwzględni przerwę przy obliczaniu przepracowanych godzin.</li>
        <li><strong>Expenses:</strong> Wprowadź ręcznie dodatkowe koszty, które mają zostać dodane do wynagrodzenia.</li>
    </ul>
    <p>System automatycznie zaktualizuje wszystkie sumy wynagrodzeń uwzględniając te dane.</p>

    <h3>3. Funkcja zapisu i wczytywania danych</h3>
    <p>Przed opuszczeniem strony możesz zapisać swoje dane:</p>
    <ul>
        <li>Kliknij przycisk <strong>Save Data</strong>, aby zapisać wszystkie wprowadzone informacje w przeglądarce.</li>
        <li>Aby wczytać zapisane dane, kliknij <strong>Load Data</strong> i następnie <strong>Calculate All</strong>, aby ponownie obliczyć wartości.</li>
    </ul>
    <p>Dane są przechowywane lokalnie w przeglądarce i dostępne na tym samym urządzeniu.</p>

    <h3>4. Generowanie raportów</h3>
    <p>Masz możliwość pobrania swoich danych w różnych formatach:</p>
    <ul>
        <li><strong>Download Report (PDF):</strong> Pobiera szczegółowy raport w formacie PDF, zawierający dane godzin pracy, stawek i wynagrodzeń oraz podsumowanie tygodniowe i miesięczne.</li>
        <li><strong>Download Data (Excel):</strong> Pobiera dane w formacie Excel.</li>
    </ul>

            <h3>5. Dodanie ikony szybkiego dostępu na pulpit</h3>
            <p>Jeśli chcesz szybko otwierać narzędzie bezpośrednio z ekranu głównego telefonu, wykonaj poniższe kroki:</p>
            <ul>
                <li><strong>Na telefonach z systemem Android:</strong></li>
                <ol>
                    <li>Otwórz stronę w przeglądarce Chrome.</li>
                    <li>Kliknij w ikonę <strong>trzech kropek</strong> w prawym górnym rogu przeglądarki.</li>
                    <li>Wybierz opcję <strong>„Dodaj do ekranu głównego”</strong>.</li>
                    <li>Nadaj nazwę ikonie, np. „Tracker Godzin”.</li>
                    <li>Kliknij <strong>„Dodaj”</strong>, a następnie potwierdź, wybierając miejsce na ekranie głównym.</li>
                </ol>
                <li><strong>Na telefonach z systemem iOS (iPhone):</strong></li>
                <ol>
                    <li>Otwórz stronę w przeglądarce Safari.</li>
                    <li>Kliknij ikonę <strong>Udostępnij</strong> (prostokąt ze strzałką w górę) znajdującą się na dole ekranu.</li>
                    <li>Wybierz opcję <strong>„Dodaj do ekranu początkowego”</strong>.</li>
                    <li>Nadaj nazwę ikonie, np. „Tracker Godzin”.</li>
                    <li>Kliknij <strong>Dodaj</strong>, aby utworzyć skrót na ekranie głównym.</li>
                </ol>
            </ul>
        </div>

        <div id="instructionEnglish" class="instruction">
            <h2>Work Hours & Salary Tracker User Manual</h2>

    <h3>1. Entering Work Hour Data</h3>
    <p>In the main section of the page, input your work hour data:</p>
    <ul>
        <li><strong>Day of the Week:</strong> Days are pre-filled for two work weeks (Week 1 and Week 2).</li>
        <li><strong>Date:</strong> Enter the date in the <em>Date</em> column (format: day-month-year).</li>
        <li><strong>Start and End Time:</strong> Fill in the <em>Start Time</em> and <em>End Time</em> fields. If working hours cross midnight, the system automatically adjusts calculations.</li>
        <li><strong>Hourly Rate:</strong> Default rates are £15.5 for weekdays and £17.5 for weekends. You can manually adjust the rate if needed.</li>
    </ul>
    <p>After entering the data, click the <strong>Calculate All</strong> button to calculate worked hours and salary.</p>

    <h3>2. Additional Earnings Table</h3>
    <p>This section allows you to input additional details related to breaks and expenses:</p>
    <ul>
        <li><strong>Unpaid Break:</strong> Choose the length of your unpaid break (in minutes) from the dropdown. The system automatically accounts for the break when calculating total hours worked.</li>
        <li><strong>Expenses:</strong> Enter any additional costs manually. These will be added to the total salary.</li>
    </ul>
    <p>The system will automatically update all salary totals to reflect these inputs.</p>

    <h3>3. Save and Load Data</h3>
    <p>Before leaving the page, you can save your data:</p>
    <ul>
        <li>Click the <strong>Save Data</strong> button to store all entered information in your browser.</li>
        <li>To reload saved data, click <strong>Load Data</strong>, then <strong>Calculate All</strong> to recalculate the values.</li>
    </ul>
    <p>Data is stored locally in your browser and accessible only on the same device and browser.</p>

    <h3>4. Generating Reports</h3>
    <p>You can download your data in different formats:</p>
    <ul>
        <li><strong>Download Report (PDF):</strong> Downloads a detailed PDF report containing work hours, rates, and salary data, as well as weekly and monthly summaries.</li>
        <li><strong>Download Data (Excel):</strong> Downloads data in Excel format.</li>
    </ul>
            <h3>5. Adding a shortcut icon to the home screen</h3>
            <p>If you want to quickly open the tool directly from your phone's home screen, follow the steps below:</p>
            <ul>
                <li><strong>On Android phones:</strong></li>
                <ol>
                    <li>Open the page in the Chrome browser.</li>
                    <li>Click the <strong>three dots</strong> icon in the upper right corner of the browser.</li>
                    <li>Select the <strong>“Add to home screen”</strong> option.</li>
                    <li>Name the icon, e.g., “Work Hours Tracker”.</li>
                    <li>Click <strong>“Add”</strong>, and then confirm by selecting a place on the home screen.</li>
                </ol>
                <li><strong>On iOS (iPhone) phones:</strong></li>
                <ol>
                    <li>Open the page in the Safari browser.</li>
                    <li>Click the <strong>Share</strong> icon (rectangle with an arrow pointing up) located at the bottom of the screen.</li>
                    <li>Select the <strong>“Add to Home Screen”</strong> option.</li>
                    <li>Name the icon, e.g., “Work Hours Tracker”.</li>
                    <li>Click <strong>Add</strong> to create a shortcut on your home screen.</li>
                </ol>
            </ul>
        </div>

        <div class="note">
            Note: Saved data can be loaded on the same device.
        </div>

        <div class="phone-container">
            <p>For best view on mobile devices, rotate your screen horizontally.</p>
            <svg class="phone-icon" fill="none" style="color: #376f39;" viewBox="0 0 24 40" xmlns="http://www.w3.org/2000/svg">
                <rect fill="none" height="38" rx="2" ry="2" stroke="currentColor" stroke-width="2" width="18" x="3" y="1"></rect>
                <rect fill="currentColor" height="2" width="8" x="8" y="33"></rect>
                <circle cx="12" cy="4" fill="currentColor" r="1.5"></circle>
            </svg>
        </div>

        <div class="footer">
            <a href="https://ibb.co/QKywb6q">
                <img src="https://i.ibb.co/sV8YmFD/yoda-dj-green-logo-zz-KOPIA-B-W.jpg" alt="yoda-dj-green-logo-zz-KOPIA-B-W">
            </a>
            <span>Copyright © GipsDrill 2024</span>
        </div>
    </div>

    <script>
        

        // Initialize Current Month
        function initCurrentMonth() {
            const now = new Date();
            const options = { month: 'long' }; // Full month name
            const monthName = new Intl.DateTimeFormat('en-US', options).format(now);
            document.getElementById('currentMonth').textContent = monthName; // Set month name
        }

        function toggleInstructionLanguage(language) {
            const polishInstruction = document.getElementById('instructionPolish');
            const englishInstruction = document.getElementById('instructionEnglish');
            if (language === 'polish') {
                polishInstruction.style.display = polishInstruction.style.display === 'block' ? 'none' : 'block';
            } else if (language === 'english') {
                englishInstruction.style.display = englishInstruction.style.display === 'block' ? 'none' : 'block';
            }
        }

        function updateNightOutCount() {
            let nightOutCountWeek1 = 0;
            let nightOutCountWeek2 = 0;

            for (let i = 1; i <= 7; i++) {
                const checkbox = document.getElementById(`nightOut${i}`);
                if (checkbox.checked) {
                    nightOutCountWeek1++;
                }
            }

            for (let i = 8; i <= 14; i++) {
                const checkbox = document.getElementById(`nightOut${i}`);
                if (checkbox.checked) {
                    nightOutCountWeek2++;
                }
            }

            document.getElementById('nightOutDaysWeek1').textContent = nightOutCountWeek1;
            document.getElementById('nightOutDaysWeek2').textContent = nightOutCountWeek2;

            // Calculate total pay for both weeks
            const rateWeek1 = parseFloat(document.getElementById('nightOutRateWeek1').value) || 28;
            const totalWeek1 = nightOutCountWeek1 * rateWeek1;
            document.getElementById('nightOutTotalWeek1').textContent = totalWeek1.toFixed(2);

            const rateWeek2 = parseFloat(document.getElementById('nightOutRateWeek2').value) || 28;
            const totalWeek2 = nightOutCountWeek2 * rateWeek2;
            document.getElementById('nightOutTotalWeek2').textContent = totalWeek2.toFixed(2);
        }

        function roundToQuarterHour(minutes) {
            return Math.round(minutes / 15) * 15;
        }

        function getTimeInMinutes(timeString) {
            const [hours, minutes] = timeString.split(':').map(Number);
            return (hours * 60) + minutes;
        }

        function calculateHours(start, end) {
            if (!start || !end) return 0;

            const startTime = getTimeInMinutes(start);
            const endTime = getTimeInMinutes(end);
            let diff = endTime - startTime;

            if (diff < 0) {
                diff += 1440; // Correction for overnight shifts
            }
            diff -= 00; // Subtract 45 minutes break
            return roundToQuarterHour(diff) / 60;
        }

        function validateInputs() {
            let isValid = true;
            let errorMessage = '';

            for (let i = 1; i <= 14; i++) {
                const start = document.getElementById(`start${i}`).value;
                const end = document.getElementById(`end${i}`).value;
                const date = document.getElementById(`date${i}`).value;

                // Only validate filled days
                if (date) {
                    if (start && end) {
                        if (getTimeInMinutes(start) >= getTimeInMinutes(end)) {
                            isValid = false;
                            errorMessage += `Error in Day ${i}: Start time must be earlier than End time.<br>`;
                        }
                    } else {
                        if (!start) {
                            isValid = false;
                            errorMessage += `Error in Day ${i}: Start time must be filled if End time is provided.<br>`;
                        }
                        if (!end) {
                            isValid = false;
                            errorMessage += `Error in Day ${i}: End time must be filled if Start time is provided.<br>`;
                        }
                    }
                }
            }

            if (!isValid) {
                document.getElementById('errorMessages').innerHTML = errorMessage;
                document.getElementById('errorMessages').style.display = 'block';
            } else {
                document.getElementById('errorMessages').style.display = 'none';
            }

            return isValid;
        }

        function calculateAll() {
    if (!validateInputs()) {
        return;
    }

    let totalHours = 0;
    let totalSalary = 0;
    let week1Hours = 0, week1Salary = 0;
    let week2Hours = 0, week2Salary = 0;

    const unpaidBreak = parseFloat(document.getElementById('unpaidBreak').value) || 0; // In minutes
    const expenses = parseFloat(document.getElementById('expenses').value) || 0;

    for (let i = 1; i <= 14; i++) {
        const start = document.getElementById(`start${i}`).value;
        const end = document.getElementById(`end${i}`).value;
        const rate = parseFloat(document.getElementById(`rate${i}`).value) || 0;

        if (start && end && rate > 0) {
            const hoursWorked = calculateHours(start, end) - (unpaidBreak / 60); // Subtract unpaid break
            const salary = hoursWorked * rate;

            totalHours += hoursWorked > 0 ? hoursWorked : 0; // Avoid negative hours
            totalSalary += salary;

            document.getElementById(`hours${i}`).textContent = hoursWorked.toFixed(2);
            document.getElementById(`salary${i}`).textContent = salary.toFixed(2);

            if (i <= 7) {
                week1Hours += hoursWorked;
                week1Salary += salary;
            } else {
                week2Hours += hoursWorked;
                week2Salary += salary;
            }
        } else {
            document.getElementById(`hours${i}`).textContent = '0';
            document.getElementById(`salary${i}`).textContent = '0';
        }
    }

    // Add Expenses
    totalSalary += expenses;

    // Night Out Calculations
    const nightOutTotalWeek1 = parseFloat(document.getElementById('nightOutTotalWeek1').textContent) || 0;
    const nightOutTotalWeek2 = parseFloat(document.getElementById('nightOutTotalWeek2').textContent) || 0;

    // Update total fields
    document.getElementById('totalHours').textContent = totalHours.toFixed(2);
    document.getElementById('totalSalary').textContent = totalSalary.toFixed(2);
    document.getElementById('totalWithNightOut').textContent = (totalSalary + nightOutTotalWeek1 + nightOutTotalWeek2).toFixed(2);

    // Update weekly summaries
    document.getElementById('week1Hours').textContent = week1Hours.toFixed(2);
    document.getElementById('week1Salary').textContent = week1Salary.toFixed(2);
    document.getElementById('week1TotalWithNightOut').textContent = (week1Salary + nightOutTotalWeek1).toFixed(2);

    document.getElementById('week2Hours').textContent = week2Hours.toFixed(2);
    document.getElementById('week2Salary').textContent = week2Salary.toFixed(2);
    document.getElementById('week2TotalWithNightOut').textContent = (week2Salary + nightOutTotalWeek2).toFixed(2);

    // Calculate combined totals
    document.getElementById('totalSalaryCombined').textContent = (
        week1Salary + nightOutTotalWeek1 + week2Salary + nightOutTotalWeek2
    ).toFixed(2);
}


// Add Expenses
    totalSalary += expenses;


        function calculateMonthlyTotals(currentTotalSalary) {
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();

            let monthlyHours = 0;
            let monthlySalary = 0;

            for (let i = 1; i <= 14; i++) {
                const date = document.getElementById(`date${i}`).value;
                const hours = parseFloat(document.getElementById(`hours${i}`).textContent) || 0;
                const salary = parseFloat(document.getElementById(`salary${i}`).textContent) || 0;

                if (date) {
                    const entryDate = new Date(date);
                    if (entryDate.getMonth() === currentMonth && entryDate.getFullYear() === currentYear) {
                        monthlyHours += hours;
                        monthlySalary += salary;
                    }
                }
            }

            const nightOutDaysWeek1 = parseInt(document.getElementById('nightOutDaysWeek1').textContent) || 0;
            const nightOutDaysWeek2 = parseInt(document.getElementById('nightOutDaysWeek2').textContent) || 0;
            const nightOutRateWeek1 = parseFloat(document.getElementById('nightOutRateWeek1').value) || 28;
            const nightOutRateWeek2 = parseFloat(document.getElementById('nightOutRateWeek2').value) || 28;

            const totalNightOutPayWeek1 = nightOutDaysWeek1 * nightOutRateWeek1;
            const totalNightOutPayWeek2 = nightOutDaysWeek2 * nightOutRateWeek2;
            const totalNightOutPay = totalNightOutPayWeek1 + totalNightOutPayWeek2;

            // Update monthly summary fields
            document.getElementById('monthlyCurrentIncludingNightOut').textContent = (monthlySalary + totalNightOutPay).toFixed(2);
            document.getElementById('monthlyPreviousIncludingNightOut').textContent = localStorage.getItem('previousMonthlySalary') || '0';
        }

        function storePreviousMonthSalary() {
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();

            // Previous month calculation
            const previousMonth = currentMonth === 0 ? 11 : currentMonth - 1;
            const previousMonthYear = previousMonth === 11 ? currentYear - 1 : currentYear;

            // Retrieve previous month's total from localStorage
            const previousMonthlySalary = localStorage.getItem('previousMonthlySalary') || 0;
            document.getElementById('previousMonthlySalary').textContent = previousMonthlySalary;

            // Store the current month's total salary as the previous month's salary for next month
            localStorage.setItem('previousMonthlySalary', document.getElementById('totalWithNightOut').textContent);
        }

        window.onload = function () {
            initCurrentMonth();
            storePreviousMonthSalary(); // Store previous month salary on load
        }

        function saveData() {
            const data = {};
            for (let i = 1; i <= 14; i++) {
                data[`date${i}`] = document.getElementById(`date${i}`).value;
                data[`start${i}`] = document.getElementById(`start${i}`).value;
                data[`end${i}`] = document.getElementById(`end${i}`).value;
                data[`rate${i}`] = document.getElementById(`rate${i}`).value;
                data[`nightOut${i}`] = document.getElementById(`nightOut${i}`).checked;
            }
            data['nightOutDaysWeek1'] = document.getElementById('nightOutDaysWeek1').textContent;
            data['nightOutDaysWeek2'] = document.getElementById('nightOutDaysWeek2').textContent;
            data['nightOutRateWeek1'] = document.getElementById('nightOutRateWeek1').value;
            data['nightOutRateWeek2'] = document.getElementById('nightOutRateWeek2').value;
            localStorage.setItem('workData', JSON.stringify(data));
            alert('Data saved!');
        }

        function loadData() {
            const data = JSON.parse(localStorage.getItem('workData'));
            if (data) {
                for (let i = 1; i <= 14; i++) {
                    document.getElementById(`date${i}`).value = data[`date${i}`] || '';
                    document.getElementById(`start${i}`).value = data[`start${i}`] || '';
                    document.getElementById(`end${i}`).value = data[`end${i}`] || '';
                    document.getElementById(`rate${i}`).value = data[`rate${i}`] || '15.5';
                    document.getElementById(`nightOut${i}`).checked = data[`nightOut${i}`] || false;
                }
                updateNightOutCount();
                alert('Data loaded!');
            } else {
                alert('No data found to load');
            }
        }

        

        function downloadExcel() {
            const workbook = XLSX.utils.book_new();
            const wsData = [['Day', 'Date', 'Start Time', 'End Time', 'Hours Worked', 'Hourly Rate', 'Salary', 'Night Out']];

            const fullDays = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
            for (let i = 1; i <= 14; i++) {
                const dayIndex = (i - 1) % 7; 
                const dayName = fullDays[dayIndex]; 
                const date = document.getElementById(`date${i}`).value;
                const start = document.getElementById(`start${i}`).value;
                const end = document.getElementById(`end${i}`).value;
                const hoursWorked = document.getElementById(`hours${i}`).textContent;
                const hourlyRate = document.getElementById(`rate${i}`).value;
                const salary = document.getElementById(`salary${i}`).textContent;
                const nightOut = document.getElementById(`nightOut${i}`).checked ? 'Yes' : 'No';

                wsData.push([dayName, date, start, end, hoursWorked, hourlyRate, salary, nightOut]);
            }

            const totalHours = document.getElementById('totalHours').textContent;
            const totalSalary = document.getElementById('totalSalary').textContent;
            const totalSalaryIncludingNightOut = document.getElementById('totalWithNightOut').textContent;
            const totalSalaryCombined = document.getElementById('totalSalaryCombined').textContent;
            const totalNightOutPayWeek1 = document.getElementById('nightOutTotalWeek1').textContent;
            const totalNightOutPayWeek2 = document.getElementById('nightOutTotalWeek2').textContent;

            wsData.push(['', '', '', '', '', 'Total Hours:', totalHours, '']);
            wsData.push(['', '', '', '', '', 'Total Salary:', totalSalary, '']);
            wsData.push(['', '', '', '', '', 'Total Night Out Pay Week 1:', totalNightOutPayWeek1, '']);
            wsData.push(['', '', '', '', '', 'Total Night Out Pay Week 2:', totalNightOutPayWeek2, '']);
            wsData.push(['', '', '', '', '', 'Total Salary including Nights Out for Week 1:', (parseFloat(totalNightOutPayWeek1) + parseFloat(document.getElementById('week1Salary').textContent)).toFixed(2), '']);
            wsData.push(['', '', '', '', '', 'Total Salary including Nights Out for Week 2:', (parseFloat(totalNightOutPayWeek2) + parseFloat(document.getElementById('week2Salary').textContent)).toFixed(2), '']);
            wsData.push(['', '', '', '', '', 'Total Salary including Nights Out for Week 1 & Week 2:', totalSalaryCombined, '']);

            const worksheet = XLSX.utils.aoa_to_sheet(wsData);
            XLSX.utils.book_append_sheet(workbook, worksheet, "Work Hours");
            XLSX.writeFile(workbook, "Work_Hours_Data.xlsx");
        }

        function generatePDF() {
    const { jsPDF } = window.jspdf; // Import jsPDF
    const pdf = new jsPDF();

    // Dodaj tytuł
    pdf.setFontSize(20);
    pdf.text("Work Hours & Salary Tracker", 10, 10);
    pdf.setFontSize(12);
    pdf.text("Generated Report", 10, 20);

    // Przygotuj dane do tabeli
    const tableData = [];
    const headers = ["Day", "Date", "Start", "End", "Hours", "Rate (£)", "Salary (£)"];
    
    for (let i = 1; i <= 14; i++) {
        const dayName = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"][(i - 1) % 7];
        const date = document.getElementById(`date${i}`).value || '-';
        const start = document.getElementById(`start${i}`).value || '-';
        const end = document.getElementById(`end${i}`).value || '-';
        const hours = document.getElementById(`hours${i}`).textContent || '0';
        const rate = document.getElementById(`rate${i}`).value || '0';
        const salary = document.getElementById(`salary${i}`).textContent || '0';

        tableData.push([dayName, date, start, end, hours, rate, salary]);
    }

    // Wygeneruj tabelę w PDF
    pdf.autoTable({
        head: [headers],
        body: tableData,
        startY: 30, // Gdzie zaczyna się tabela
    });

    // Dodaj podsumowanie tygodniowe
    let y = pdf.autoTable.previous.finalY + 10; // Przerwa po tabeli
    pdf.setFontSize(12);
    pdf.text("Weekly Summary", 10, y);
    y += 10;

    const week1Hours = document.getElementById('week1Hours').textContent || '0';
    const week1TotalWithNightOut = document.getElementById('week1TotalWithNightOut').textContent || '0';
    const week2Hours = document.getElementById('week2Hours').textContent || '0';
    const week2TotalWithNightOut = document.getElementById('week2TotalWithNightOut').textContent || '0';
    const totalSalaryCombined = document.getElementById('totalSalaryCombined').textContent || '0';

    const weeklySummary = [
        `Week 1: Total Hours: ${week1Hours}`,
        `Week 1: Total including Night Out: £${week1TotalWithNightOut}`,
        `Week 2: Total Hours: ${week2Hours}`,
        `Week 2: Total including Night Out: £${week2TotalWithNightOut}`,
        `Total Salary including Nights Out for Week 1 & Week 2: £${totalSalaryCombined}`
    ];

    weeklySummary.forEach((line) => {
        pdf.text(line, 10, y);
        y += 10;
    });

    // Dodaj podsumowanie ogólne
    y += 10; // Przerwa przed podsumowaniem
    pdf.text(`Total Hours Worked: ${document.getElementById('totalHours').textContent || '0'}`, 10, y);
    pdf.text(`Total Salary: £${document.getElementById('totalSalary').textContent || '0'}`, 10, y + 10);
    pdf.text(`Total Salary including Night Out: £${document.getElementById('totalWithNightOut').textContent || '0'}`, 10, y + 20);

    // Zapisz plik PDF
    pdf.save('work_hours_report.pdf');
}

    </script>
</body>

</html>
